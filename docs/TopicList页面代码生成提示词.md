# TopicList 页面代码生成提示词（管理后台列表页，Element Plus 版）

## 角色与目标

你是一名资深前端重构工程师，精通 Element Plus 与 Vue 3 Composition API，严格遵循本项目现有的 API 封装与状态管理方式（Pinia）。

你的任务：实现"专题列表管理"页面（TopicList.vue），复刻图片中的页面布局和样式，提供基础的专题列表展示功能，并集成到AdminLayout布局中。

- 目标 1：复刻图片中的页面布局和视觉样式（搜索区域、表格展示、操作按钮）。
- 目标 2：实现基础的数据表格展示（ID、标题、封面、统计信息、时间、状态、操作）。
- 目标 3：实现新建页面按钮跳转到TopicCreate.vue页面。
- 目标 4：与AdminLayout布局完美集成，保持一致的视觉风格。
- 目标 5：实现删除专题功能，调用后端API进行实际删除操作。
- 目标 6：其他功能暂时使用静态数据或占位实现，为后续开发预留接口。

## 页面功能范围说明（管理后台列表）

- 搜索筛选区域：页面标题输入框、页面ID输入框、状态下拉选择、搜索按钮（暂时静态，后端未实现搜索）。
- 操作按钮区域：新建页面按钮（跳转到TopicCreate.vue）、查看教程链接（静态）。
- 数据表格展示：
  - 基础信息：ID、页面标题、封面缩略图
  - 统计信息：包含子页面数、总浏览量、总访客数（带问号提示图标，暂时显示静态数据）
  - 时间信息：创建时间
  - 状态信息：已发布/草稿/已归档等状态标签
  - 操作列：编辑、停用、分享、删除、复制、打标签、数据等操作（删除功能已实现，其他暂时静态）
- 分页功能：支持分页显示和每页条数设置（使用后端API）

## 设计与布局（AdminLayout集成）

- 整体布局：使用AdminLayout作为外层容器，页面内容区域使用el-container
- 搜索筛选区域：
  - 左侧：页面标题输入框（placeholder: "请输入标题"）
  - 中间：页面ID输入框（placeholder: "请输入页面ID"）  
  - 右侧：状态下拉选择（默认"全部"，包含全部/草稿/已发布/已归档选项）
  - 搜索按钮：蓝色主色调
- 操作按钮区域：
  - 右侧：蓝色"新建页面"按钮
  - 右侧：灰色"查看教程"文字链接
- 数据表格：
  - 表头：ID、页面标题、封面、包含子页面、总浏览量、总访客数、创建时间、状态、操作
  - 封面列：120px宽度，显示缩略图，支持预览
  - 统计列：包含子页面、总浏览量、总访客数显示数字，带问号提示图标
  - 状态列：使用不同颜色的标签显示状态
  - 操作列：垂直排列的操作按钮（编辑、停用、分享、删除、复制、打标签、数据）

## API 需求说明（当前可用接口）

根据后端文档，当前已实现的接口：

- 获取专题列表：
  - `GET /api/v1/topics`
  - Query参数：`page`, `size`, `sort`, `status`, `user_id`
  - 响应格式：
    ```json
    {
      "code": 200,
      "message": "success", 
      "data": {
        "total": 5,
        "page": 1,
        "size": 10,
        "items": [
          {
            "id": "topic_uuid_1",
            "title": "侠者仁心·纵横论道",
            "status": "published",
            "banner_url": "/media/topics/banner_main.jpg",
            "created_at": "2025-10-15T10:00:00Z"
          }
        ]
      }
    }
    ```

**注意**：后端目前未实现搜索功能（title、topic_id筛选），部分操作接口（更新、复制等）也未实现，因此：
- 搜索筛选功能暂时使用静态UI，不调用后端接口
- 删除功能已实现，调用后端API进行实际删除操作
- 其他操作按钮暂时显示静态样式，点击时显示"功能待开发"提示
- 统计信息（浏览量、访客数、子页面数）暂时显示静态数据
- 实现基础的列表展示、分页功能和删除功能

鉴权：统一使用 JWT，前端请求工具 `utils/request.ts` 已自动注入 `Authorization: Bearer <token>`。

## 核心原则

1. 组件统一：所有 UI 使用 Element Plus；表格、表单、弹窗、提示用 EP 组件。
2. 数据契约：严格按照后端API契约处理数据，避免字段不匹配。
3. 状态管理：使用Pinia `useTopicStore()`进行状态管理，与现有代码风格保持一致。
4. 代码风格：复用项目通用请求封装、错误处理、URL规范化等工具函数。
5. 用户体验：加载状态、错误提示、操作确认、防重复提交等完善的交互体验。
6. 渐进式开发：当前阶段专注于UI复刻和基础功能，为后续功能开发预留接口和扩展点。

---

## 任务一：创建 TopicList 页面（管理后台列表）

文件路径：`/src/pages/topic/TopicList.vue`

### 1. 页面布局（<template>）

- 使用 `AdminLayout` 作为外层布局容器
- 页面内容使用 `el-container` + `el-card` 组织：
  - 搜索筛选卡片：包含标题输入、ID输入、状态选择、搜索按钮
  - 操作按钮区域：新建页面按钮、查看教程链接
  - 数据表格卡片：包含表格、分页、批量操作
- 表格结构：
  - 选择列：支持多选
  - ID列：显示专题ID（可截断显示）
  - 页面标题列：显示专题标题，支持溢出省略
  - 封面列：显示缩略图，支持预览
  - 包含子页面列：显示数字，带问号提示
  - 总浏览量列：显示数字，带问号提示  
  - 总访客数列：显示数字，带问号提示
  - 创建时间列：格式化显示时间
  - 状态列：使用标签显示状态
  - 操作列：垂直排列的操作按钮

### 2. 逻辑与样式（<script setup> + <style scoped>）

逻辑要点：
- 状态管理：`useTopicStore()`，响应式数据 `topics`, `loading`, `error`
- 搜索筛选：`filterForm` 包含 `title`, `topic_id`, `status`（暂时静态，不调用后端）
- 分页数据：`pagination` 包含 `page`, `pageSize`, `total`
- 数据加载：`loadTopics()` 方法处理列表加载（仅调用基础列表API）
- 操作处理：
  - 新建页面：`goToCreate()` 跳转到TopicCreate.vue页面
  - 删除功能：`handleAction('delete', topic)` 调用后端API删除专题，包含确认对话框
  - 其他操作：暂时显示"功能待开发"提示，为后续开发预留接口
- 状态管理：`getStatusType()`, `getStatusText()` 处理状态显示
- 图片处理：`getBannerSrc()` 处理封面图片URL规范化
- 时间格式化：`formatDateTime()` 格式化创建时间显示
- 静态数据：统计信息暂时使用模拟数据，操作按钮暂时静态显示

### 3. 组件与依赖

必用 EP 组件：`ElContainer`, `ElCard`, `ElForm`, `ElFormItem`, `ElInput`, `ElSelect`, `ElOption`, `ElButton`, `ElTable`, `ElTableColumn`, `ElPagination`, `ElTag`, `ElImage`, `ElMessage`, `ElMessageBox`, `ElTooltip`, `ElDropdown`, `ElDropdownMenu`, `ElDropdownItem`, `ElPopconfirm`, `ElDialog`。

---

## 任务二：数据与交互细节

1) 搜索筛选数据模型
```ts
interface TopicListFilter {
  title?: string
  topic_id?: string  
  status?: 'draft' | 'published' | 'archived' | ''
}
```

2) 分页数据模型
```ts
interface PaginationData {
  page: number
  pageSize: number
  total: number
}
```

3) 专题列表项数据模型（对齐后端API响应）
```ts
interface TopicListItem {
  id: string
  title: string
  banner_url?: string
  status: 'draft' | 'published' | 'archived'
  created_at: string
  // 以下字段暂时使用静态数据，等待后端实现
  sub_pages_count?: number
  total_views?: number
  total_visitors?: number
}
```

4) 操作类型定义（暂时静态实现）
```ts
type TopicAction = 'edit' | 'disable' | 'share' | 'delete' | 'copy' | 'tag' | 'data'
// 注意：这些操作暂时显示静态UI，点击时显示"功能待开发"提示
```

### 5) 交互流程（当前实现范围）

1) 页面加载：自动加载专题列表数据（调用基础列表API）
2) 搜索筛选：UI显示搜索框，但暂时不调用后端接口（后端未实现搜索功能）
3) 状态筛选：UI显示状态选择，但暂时不调用后端接口（后端未实现搜索功能）
4) 分页操作：切换页码或每页条数时重新加载数据（调用基础列表API）
5) 新建页面：点击"新建页面"按钮跳转到TopicCreate.vue页面
6) 删除功能：点击"删除"链接时：
   - 显示确认对话框："确定要删除这个专题吗？此操作不可恢复！"
   - 用户确认后调用`topicStore.deleteTopic(topic.id)`
   - 删除成功后显示成功消息并重新加载列表
   - 删除失败时显示错误信息
7) 其他操作：暂时显示静态UI，点击时显示"功能待开发"提示：
   - 编辑、停用、分享、复制、打标签、数据等操作按钮
   - 批量操作功能

### 6) 错误处理与用户体验

- 加载状态：表格显示loading状态，禁用操作按钮
- 错误提示：使用ElMessage显示操作结果和错误信息
- 删除确认：删除操作需要二次确认，防止误操作
- 功能待开发提示：未实现的操作点击时显示"功能待开发，敬请期待"
- 空状态：无数据时显示友好的空状态提示
- 图片加载失败：显示默认占位图
- 统计信息占位：浏览量、访客数等显示静态数据（如"0"或模拟数据）

### 7) 安全与鉴权

- 请求头自动注入 JWT token
- 401错误时触发重新登录
- 操作权限检查（根据用户角色显示不同操作）
- 敏感操作记录日志

---

## 任务三：路由与接入

- 路由配置：`/pages/topic/TopicList`
- 布局集成：使用 `AdminLayout` 作为页面布局
- 入口导航：
  - 从管理后台主导航进入
  - 从其他页面的"专题管理"链接进入
- 页面跳转：
  - 新建专题：跳转到 `/pages/topic/TopicCreate`
  - 编辑专题：跳转到 `/pages/topic/TopicManage?topic_id={id}`
  - 查看专题：跳转到 `/pages/topic/TopicDisplay?topic_id={id}`
  - 数据统计：跳转到专题数据页面

---

## 关键实现要点 Checklist

- [ ] AdminLayout布局集成：正确使用布局组件，保持视觉一致性
- [ ] 搜索筛选UI：标题、ID、状态筛选框显示，暂时不调用后端接口
- [ ] 数据表格展示：所有列正确显示，严格按照后端API响应格式
- [ ] 封面图片处理：缩略图显示、预览功能、加载失败处理
- [ ] 状态标签显示：不同状态使用不同颜色标签
- [ ] 新建页面跳转：正确跳转到TopicCreate.vue页面
- [ ] 删除功能实现：删除按钮调用后端API，包含确认对话框和错误处理
- [ ] 操作按钮UI：其他操作按钮正确显示，点击时显示"功能待开发"提示
- [ ] 分页功能：分页组件正确配置，支持页码和每页条数设置
- [ ] 加载状态：表格loading、按钮loading、空状态显示
- [ ] 错误处理：网络错误、API调用失败等场景处理
- [ ] 响应式设计：移动端适配，表格横向滚动
- [ ] 数据契约：严格按照后端API契约处理数据
- [ ] 状态管理：使用topicStore，与现有代码风格一致
- [ ] URL规范化：图片URL、跳转URL正确处理
- [ ] 静态数据：统计信息使用模拟数据，为后续开发预留接口

---

## 特殊功能说明

### 1. 统计信息提示图标（静态实现）
- 包含子页面、总浏览量、总访客数列显示问号图标
- 鼠标悬停显示详细说明tooltip
- 图标样式：小号问号，灰色，与数字对齐
- 数据暂时显示静态值（如"0"或模拟数据）

### 2. 操作列垂直布局（删除功能已实现）
- 操作按钮垂直排列，节省横向空间
- 按钮样式：小号按钮，蓝色链接样式
- 危险操作（删除）使用红色样式，已实现实际删除功能
- 操作间用分隔线区分
- 删除功能：包含确认对话框、API调用、成功/失败反馈
- 其他操作点击时显示"功能待开发，敬请期待"提示

### 3. 封面图片处理
- 缩略图尺寸：120px宽度，高度自适应
- 支持点击预览大图
- 加载失败显示默认占位图
- 图片URL规范化处理

### 4. 状态标签颜色
- 已发布：绿色（success）
- 草稿：灰色（info）  
- 已归档：橙色（warning）
- 其他状态：默认灰色

### 5. 搜索筛选功能（静态UI）
- 搜索框和状态选择器正常显示
- 点击搜索按钮时显示"搜索功能待开发"提示
- 为后续后端实现搜索功能预留接口

### 6. 新建页面功能（已实现）
- "新建页面"按钮正确跳转到TopicCreate.vue
- 使用uni.navigateTo进行页面跳转
- 保持与现有代码风格一致

### 7. 删除专题功能（已实现）
- 删除按钮调用后端API：`DELETE /api/v1/topics/{topic_id}`
- 包含二次确认对话框，防止误操作
- 删除成功后自动刷新列表数据
- 完整的错误处理和用户反馈
- 支持JWT鉴权，确保操作安全性
